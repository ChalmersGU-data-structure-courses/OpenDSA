
<!DOCTYPE html>




<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.18. Solving Recurrence Relations (optional) (WORK IN PROGRESS) &mdash; Data Structures and Algorithms</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/normalize.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/JSAV.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/odsaMOD-min.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/jquery.ui.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/odsaStyle-min.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/accessibility.css" type="text/css" />
    
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.4.1',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
      },
      "HTML-CSS": {
        scale: "80"
      }
    });
  </script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="index" title="Data Structures and Algorithms" href="index.html" />
    <link rel="next" title="19. Amortized Analysis (optional) (WORK IN PROGRESS)" href="AmortAnal.html" />
    <link rel="prev" title="17. Summation Techniques (optional) (WORK IN PROGRESS)" href="AdvSumm.html" />

  </head>

  <body>


      <div class="header">
        
  
      <script type="text/javascript" src="../../../lib/jquery.min.js"></script>
      <script type="text/javascript" src="../../../lib/jquery.migrate.min.js"></script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/localforage/1.9.0/localforage.min.js"></script>
      <script type="text/javascript" src="../../../lib/accessibility.js"></script>
    <script type="text/javascript" src="../../../lib/jquery.ui.min.js"></script>
    <script type="text/javascript" src="../../../lib/jquery.transit.js"></script>
    <script type="text/javascript" src="../../../lib/raphael.js"></script>
    <script type="text/javascript" src="../../../lib/JSAV-min.js"></script>
    <script type="text/javascript" src="_static/config.js"></script>
    <script type="text/javascript" src="../../../lib/timeme-min.js"></script>
    <script type="text/javascript" src="../../../lib/odsaUtils-min.js"></script>
    <script type="text/javascript" src="../../../lib/odsaMOD-min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
    <script type="text/javascript" src="https://d3js.org/d3-selection-multi.v1.min.js"></script>
    <script type="text/javascript" src="../../../lib/dataStructures.js"></script>
    <script type="text/javascript" src="../../../lib/conceptMap.js"></script>

        
<a id="username-link" style="float:right;color:red;margin:10px 20px auto; display: none" class="username-link" href="Gradebook.html"></a>
<a id="login-link" style="float:right;color:red;margin:10px 20px auto" class="login-link" href="#"><Macro 'login'></a>
<div id="login-box" class="login-popup">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close" /></a>
  <form method="post" class="signin" action="https://#">
    <fieldset class="textbox">
      <label class="username">
        <span>Username</span>
        <input id="username" value="" type="text" autocomplete="on" placeholder="Username" tabindex="1">
      </label>
      <label class="password">
        <span>Password</span>
        <input id="password" value="" type="password" placeholder="Password" tabindex="2">
        <span><a id="forgot" href="#">Forgot your password?</a></span>
      </label>

      <p>
        <input type="submit" id="login-submit-button" value="Sign in" tabindex="3" />
      </p>
      <p>
        <input type="button" id="register-button" value="Register" tabindex="4" />
      </p>
    </fieldset>
  </form>
</div>

        
<a id="registration-link" style="float:right;color:red;margin:10px 20px auto" class="registration-link" href="#">Register</a>
<div id="registration-box" class="registration-popup ">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close Window" /></a>
  <form method="post" class="signin" action="https://#">
    <fieldset class="textbox">
      <div id="register_error" class="error"></div>
      <label class="username">
        <span>Username:</span>
        <input type="text" id="user" placeholder="Username" />
      </label>

      <label class="password">
        <span>Password</span>
        <input id="pass" type="password" placeholder="Password" />
      </label>

      <label class="password">
        <span>Confirm Password</span>
        <input id="rpass" type="password" placeholder="Confirm Password" />
      </label>

      <label class="email">
        <span>Email:</span>
        <input type="text" id="email" placeholder="Email">
      </label>

      <p>
        <input type="submit" id="register-submit-button" value="Register &rarr;"/>
      </p>
    </fieldset>
  </form>
</div>
<img class="leftlogo" src="_static/OpenDSALogoT64.png" alt="Logo"/><div class="title-wrapper">
          <div class="title-inbetween" style="display: table-cell; vertical-align: middle;">
            <div class="title-content">
              <h1 class="heading" ><a href="index.html">
                <span>Data Structures and Algorithms</span></a></h1>
              <h2 class="heading" ><span>Chapter 3 Algorithm Analysis</span></h2>
            </div>
          </div>
        </div>
      </div>
      <div class="topnav">
        <p>
            <a style="float:left;color:blue;" href="../source/Recurrence.rst.rst"
              target="_blank" rel="nofollow">Show Source | </a>&#160;&#160;
            <a class="abt" style="float:left;color:blue;" href="#" rel="nofollow">| About</a>&#160;&#160;

          
        «&#160;&#160;<a id="prevmod" href="AdvSumm.html">3.<span class="section-number">17. </span>Summation Techniques (optional) (WORK IN PROGRESS)</a>
        &#160;&#160;::&#160;&#160;
        <a  class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a  id="nextmod" href="AmortAnal.html">3.<span class="section-number">19. </span>Amortized Analysis (optional) (WORK IN PROGRESS)</a>&#160;&#160;»


        </p>
      </div>
       
      <div class="content">
        
  <script>ODSA.SETTINGS.MODULE_SECTIONS = ['solving-recurrence-relations', 'estimating-upper-and-lower-bounds', 'expanding-recurrences', 'divide-and-conquer-recurrences', 'average-case-analysis-of-quicksort'];</script><script>ODSA.SETTINGS.DISP_MOD_COMP = true;ODSA.SETTINGS.MODULE_NAME = "Recurrence";ODSA.SETTINGS.MODULE_LONG_NAME = "Solving Recurrence Relations (optional) (WORK IN PROGRESS)";ODSA.SETTINGS.MODULE_CHAPTER = "Algorithm Analysis"; ODSA.SETTINGS.BUILD_DATE = "2021-12-05 12:47:14"; ODSA.SETTINGS.BUILD_CMAP = true;JSAV_OPTIONS['lang']='en';JSAV_EXERCISE_OPTIONS['code']='pseudo';</script><link href="../../../AV//SeniorAlgAnal/ExpandRecurrenceCON.css" rel="stylesheet" type="text/css" />
<link href="../../../AV/SeniorAlgAnal/DandCRecurrenceCON.css" rel="stylesheet" type="text/css" />
<div class="section" id="solving-recurrence-relations-optional-work-in-progress">
<h1>3.<span class="section-number">18. </span>Solving Recurrence Relations (optional) (WORK IN PROGRESS)<a class="headerlink" href="#solving-recurrence-relations-optional-work-in-progress" title="Permalink to this headline">¶</a></h1>
<div class="section" id="solving-recurrence-relations">
<h2>3.<span class="section-number">18.1. </span>Solving Recurrence Relations<a class="headerlink" href="#solving-recurrence-relations" title="Permalink to this headline">¶</a></h2>
<a id="todo0"></a><div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<dl class="simple">
<dt>type: Equation cross-reference</dt><dd><p>Throughout this module, there are references to equations, both
on this page and in the Summations module. These should be made
into proper cross-references rather than hard-coded equation numbers.</p>
</dd>
</dl>
</div>
<p>Recurrence relations are often used to model the cost of recursive
functions.
For example, the standard <a class="reference internal" href="Mergesort.html#mergesort"><span class="std std-ref">Mergesort</span></a>
takes a list of size <span class="math notranslate nohighlight">\(n\)</span>, splits it in half, performs Mergesort
on each half, and finally merges the two sublists in <span class="math notranslate nohighlight">\(n\)</span> steps.
The cost for this can be modeled as</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = 2{\bf T}(n/2) + n.\]</div>
<p>In other words, the cost of the algorithm on input of
size <span class="math notranslate nohighlight">\(n\)</span> is two times the cost for input of size <span class="math notranslate nohighlight">\(n/2\)</span>
(due to the two recursive calls to Mergesort) plus <span class="math notranslate nohighlight">\(n\)</span>
(the time to merge the sublists together again).</p>
<p>There are many approaches to solving recurrence relations, and we
briefly consider three here.
The first is an estimation technique:
Guess the upper and lower bounds for the recurrence, use
induction to prove the bounds, and tighten as required.
The second approach is to expand the recurrence to convert it to a
summation and then use summation techniques.
The third approach is to take advantage of already proven theorems
when the recurrence is of a suitable form.
In particular, typical divide-and-conquer algorithms such as
Mergesort yield recurrences of a form that fits a pattern for which
we have a ready solution.</p>
<div class="section" id="estimating-upper-and-lower-bounds">
<h3>3.<span class="section-number">18.1.1. </span>Estimating Upper and Lower Bounds<a class="headerlink" href="#estimating-upper-and-lower-bounds" title="Permalink to this headline">¶</a></h3>
<p>The first approach to solving recurrences is to guess the
answer and then attempt to prove it correct.
If a correct upper or lower bound estimate is given,
an easy induction proof will verify this fact.
If the proof is successful, then try to tighten the bound.
If the induction proof fails, then loosen the bound and try again.
Once the upper and lower bounds match, you are finished.
This is a useful technique when you are only looking for asymptotic
complexities.
When seeking a precise closed-form solution (i.e., you seek the
constants for the expression), this method will probably be too much
work.</p>
<div class="topic">
<p class="topic-title">Example 3.19.1 </p>
<p>Use the guessing technique to find the asymptotic bounds for
Mergesort, whose running time is described by the equation</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = 2{\bf T}(n/2) + n; \quad {\bf T}(2) = 1.\]</div>
<p>We begin by guessing that this recurrence has an upper
bound in <span class="math notranslate nohighlight">\(O(n^2)\)</span>.
To be more precise, assume that</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) \leq n^2.\]</div>
<p>We prove this guess is correct by induction.
In this proof, we assume that <span class="math notranslate nohighlight">\(n\)</span> is a
power of two, to make the calculations easy.
For the base case, <span class="math notranslate nohighlight">\({\bf T}(2) = 1 \leq 2^2\)</span>.
For the induction step, we need to show that
<span class="math notranslate nohighlight">\({\bf T}(n) \leq n^2\)</span> implies that
<span class="math notranslate nohighlight">\({\bf T}(2n) \leq (2n)^2\)</span> for <span class="math notranslate nohighlight">\(n = 2^N, N \geq 1\)</span>.
The induction hypothesis is</p>
<div class="math notranslate nohighlight">
\[{\bf T}(i) \leq i^2,\ {\rm for\ all}\ i \leq n.\]</div>
<p>It follows that</p>
<div class="math notranslate nohighlight">
\[{\bf T}(2n) = 2{\bf T}(n) + 2n \leq 2n^2 + 2n \leq 4n^2 \leq (2n)^2\]</div>
<p>which is what we wanted to prove.
Thus, <span class="math notranslate nohighlight">\({\bf T}(n)\)</span> is in <span class="math notranslate nohighlight">\(O(n^2)\)</span>.</p>
<p>Is <span class="math notranslate nohighlight">\(O(n^2)\)</span> a good estimate?
In the next-to-last step we went from <span class="math notranslate nohighlight">\(n^2 + 2n\)</span> to the much
larger <span class="math notranslate nohighlight">\(4n^2\)</span>.
This suggests that  <span class="math notranslate nohighlight">\(O(n^2)\)</span> is a high estimate.
If we guess something smaller, such as <span class="math notranslate nohighlight">\({\bf T}(n) \leq cn\)</span>
for some constant <span class="math notranslate nohighlight">\(c\)</span>, it should be clear that this cannot
work because <span class="math notranslate nohighlight">\(c 2 n = 2 c n\)</span> and there is no room for the
extra <span class="math notranslate nohighlight">\(n\)</span> cost to join the two pieces together.
Thus, the true cost must be somewhere between <span class="math notranslate nohighlight">\(cn\)</span> and
<span class="math notranslate nohighlight">\(n^2\)</span>.</p>
<p>Let us now try <span class="math notranslate nohighlight">\({\bf T}(n) \leq n \log n\)</span>.
For the base case, the definition of the recurrence sets
<span class="math notranslate nohighlight">\({\bf T}(2) = 1 \leq (2 \cdot \log 2) = 2\)</span>.
Assume (induction hypothesis) that <span class="math notranslate nohighlight">\({\bf T}(n) \leq n \log n\)</span>.
Then,</p>
<div class="math notranslate nohighlight">
\[{\bf T}(2n) = 2{\bf T}(n) + 2n \leq 2n \log n + 2n
\leq 2n(\log n + 1) \leq 2 n \log 2n\]</div>
<p>which is what we seek to prove.
In similar fashion, we can prove that <span class="math notranslate nohighlight">\({\bf T}(n)\)</span> is in
<span class="math notranslate nohighlight">\(\Omega(n \log n)\)</span>.
Thus, <span class="math notranslate nohighlight">\({\bf T}(n)\)</span> is also <span class="math notranslate nohighlight">\(\Theta(n \log n)\)</span>.</p>
</div>
<div class="topic">
<p class="topic-title">Example 3.19.2 </p>
<p>We know that the factorial function grows exponentially.
How does it compare to <span class="math notranslate nohighlight">\(2^n\)</span>? To <span class="math notranslate nohighlight">\(n^n\)</span>?
Do they all grow “equally fast” (in an asymptotic sense)?
We can begin by looking at a few initial terms.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{r|rrrrrrrrr}
n&amp;1&amp;2&amp;3&amp;4&amp;5&amp;6&amp;7&amp;8&amp;9\\
\hline
n! &amp;1&amp;2&amp;6&amp;24&amp;120&amp;720&amp;5040&amp;40320&amp;362880\\
2^n&amp;2&amp;4&amp;8&amp;16&amp;32&amp;64&amp;128&amp;256&amp;512\\
n^n&amp;1&amp;4&amp;9&amp;256&amp;3125&amp;46656&amp;823543&amp;16777216&amp;387420489
\end{array}\end{split}\]</div>
<p>We can also look at these functions in terms of their recurrences.</p>
<div class="math notranslate nohighlight">
\[\begin{split}n! = \left\{
\begin{array}{ll}
1&amp;n=1\\
n(n-1)!&amp;n&gt;1\\
\end{array}
\right.\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}2^n = \left\{
\begin{array}{ll}
2&amp;n=1\\
2(2^{n-1})&amp;n&gt;1\\
\end{array}
\right.\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}n^n = \left\{
\begin{array}{ll}
n&amp;n=1\\
n(n^{n-1})&amp;n&gt;1\\
\end{array}
\right.\end{split}\]</div>
<p>At this point, our intuition should be telling us pretty clearly
the relative growth rates of these three functions.
But how do we prove formally which grows the fastest?
And how do we decide if the differences are significant in an
asymptotic sense, or just constant factor differences?</p>
<p>We can use logarithms to help us get an idea about the relative
growth rates of these functions.
Clearly, <span class="math notranslate nohighlight">\(\log 2^n = n\)</span>.
Equally clearly, <span class="math notranslate nohighlight">\(\log n^n = n \log n\)</span>.
We can easily see from this that <span class="math notranslate nohighlight">\(2^n\)</span> is <span class="math notranslate nohighlight">\(o(n^n)\)</span>,
that is, <span class="math notranslate nohighlight">\(n^n\)</span> grows asymptotically faster than <span class="math notranslate nohighlight">\(2^n\)</span>.</p>
<p>How does <span class="math notranslate nohighlight">\(n!\)</span> fit into this?
We can again take advantage of logarithms.
Obviously <span class="math notranslate nohighlight">\(n! \leq n^n\)</span>, so we know that <span class="math notranslate nohighlight">\(\log n!\)</span> is
<span class="math notranslate nohighlight">\(O(n \log n)\)</span>.
But what about a lower bound for the factorial function?
Consider the following.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray*}
n! &amp;=&amp; n \times (n - 1) \times \cdots \times \frac{n}{2} \times
(\frac{n}{2} - 1) \times \cdots \times 2 \times 1\\
&amp;\geq&amp; \frac{n}{2} \times \frac{n}{2} \times \cdots \times \frac{n}{2}
\times 1 \times \cdots \times 1 \times 1\\
&amp;=&amp; (\frac{n}{2})^{n/2}
\end{eqnarray*}\end{split}\]</div>
<p>Therefore</p>
<div class="math notranslate nohighlight">
\[\log n! \geq \log(\frac{n}{2})^{n/2} =
(\frac{n}{2})\log(\frac{n}{2}).\]</div>
<p>In other words, <span class="math notranslate nohighlight">\(\log n!\)</span> is in <span class="math notranslate nohighlight">\(\Omega(n \log n)\)</span>.
Thus, <span class="math notranslate nohighlight">\(\log n! = \Theta(n \log n)\)</span>.</p>
<p>Note that this does <strong>not</strong> mean that <span class="math notranslate nohighlight">\(n! = \Theta(n^n)\)</span>.
Because <span class="math notranslate nohighlight">\(\log n^2 = 2 \log n\)</span>, it follows that
<span class="math notranslate nohighlight">\(\log n = \Theta(\log n^2)\)</span> but <span class="math notranslate nohighlight">\(n \neq \Theta(n^2)\)</span>.
The log function often works as a “flattener” when dealing with
asymptotics.
That is, whenever <span class="math notranslate nohighlight">\(\log f(n)\)</span> is in <span class="math notranslate nohighlight">\(O(\log g(n))\)</span> we
know that <span class="math notranslate nohighlight">\(f(n)\)</span> is in <span class="math notranslate nohighlight">\(O(g(n))\)</span>.
But knowing that <span class="math notranslate nohighlight">\(\log f(n) = \Theta(\log g(n))\)</span> does not
necessarily mean that <span class="math notranslate nohighlight">\(f(n) = \Theta(g(n))\)</span>.</p>
</div>
<div class="topic">
<p class="topic-title">Example 3.19.3 </p>
<p>What is the growth rate of the Fibonacci sequence?
We define the Fibonacci sequence as
<span class="math notranslate nohighlight">\(f(n) = f(n-1) + f(n-2)\)</span> for <span class="math notranslate nohighlight">\(n \geq 2\)</span>;
<span class="math notranslate nohighlight">\(f(0) = f(1) = 1\)</span>.</p>
<p>In this case it is useful to compare the ratio of <span class="math notranslate nohighlight">\(f(n)\)</span> to
<span class="math notranslate nohighlight">\(f(n-1)\)</span>.
The following table shows the first few values.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|lllllll}
n&amp;1&amp;2&amp;3&amp;4&amp;5&amp;6&amp;7\\
\hline
f(n)&amp;1&amp;2&amp;3&amp;5&amp;8&amp;13&amp;21\\
f(n)/f(n-1)&amp;1&amp;2&amp;1.5&amp;1.666&amp;1.625&amp;1.615&amp;1.619
\end{array}\end{split}\]</div>
<p>If we continue for more terms, the ratio appears to converge on a
value slightly greater then 1.618.
Assuming <span class="math notranslate nohighlight">\(f(n)/f(n-1)\)</span> really does converge to a fixed value
as <span class="math notranslate nohighlight">\(n\)</span> grows, we can determine what that value must be.</p>
<div class="math notranslate nohighlight">
\[\frac{f(n)}{f(n-2)} = \frac{f(n-1)}{f(n-2)} + \frac{f(n-2)}{f(n-2)}
\rightarrow x+1\]</div>
<p>for some value <span class="math notranslate nohighlight">\(x\)</span>.
This follows from the fact that <span class="math notranslate nohighlight">\(f(n) = f(n-1) + f(n-2)\)</span>.
We divide by <span class="math notranslate nohighlight">\(f(n-2)\)</span> to make the second term go away, and we
also get something useful in the first term.
Remember that the goal of such manipulations is to give us an
equation that relates <span class="math notranslate nohighlight">\(f(n)\)</span> to something without recursive
calls.</p>
<p>For large <span class="math notranslate nohighlight">\(n\)</span>, we also observe that:</p>
<div class="math notranslate nohighlight">
\[\frac{f(n)}{f(n-2)} = \frac{f(n)}{f(n-1)}\frac{f(n-1)}{f(n-2)}
\rightarrow x^2\]</div>
<p>as <span class="math notranslate nohighlight">\(n\)</span> gets big.
This comes from multiplying <span class="math notranslate nohighlight">\(f(n)/f(n-2)\)</span> by
<span class="math notranslate nohighlight">\(f(n-1)/f(n-1)\)</span> and rearranging.</p>
<p>If <span class="math notranslate nohighlight">\(x\)</span> exists, then <span class="math notranslate nohighlight">\(x^2 - x - 1 \rightarrow 0\)</span>.
Using the quadratic equation, the only solution greater than one is</p>
<div class="math notranslate nohighlight">
\[x = \frac{1 + \sqrt{5}}{2} \approx 1.618.\]</div>
<p>This expression also has the name <span class="math notranslate nohighlight">\(\phi\)</span>.
What does this say about the growth rate of the Fibonacci sequence?
It is exponential, with <span class="math notranslate nohighlight">\(f(n) = \Theta(\phi^n)\)</span>.
More precisely, <span class="math notranslate nohighlight">\(f(n)\)</span> converges to</p>
<div class="math notranslate nohighlight">
\[\frac{\phi^n - (1 - \phi)^n}{\sqrt{5}}.\]</div>
</div>
</div>
<div class="section" id="expanding-recurrences">
<h3>3.<span class="section-number">18.1.2. </span>Expanding Recurrences<a class="headerlink" href="#expanding-recurrences" title="Permalink to this headline">¶</a></h3>
<p>Estimating bounds is effective if you only need an approximation to
the answer.
More precise techniques are required to find an exact solution.
One approach is called <a class="reference internal" href="Glossary.html#term-expanding-the-recurrence"><span class="xref std std-term">expanding the recurrence</span></a>.
In this method, the smaller terms on the right side of the equation
are in turn replaced by their definition.
This is the expanding step.
These terms are again expanded, and so on, until a full series
with no recurrence results.
This yields a <a class="reference internal" href="Glossary.html#term-summation"><span class="xref std std-term">summation</span></a>,
and techniques for solving summations can then be used.</p>
<div id="ExpandRecurrenceCON" class="ssAV" data-points="0.0" data-threshold="1.0" data-type="ss" data-required="False" data-short-name="ExpandRecurrenceCON" data-long-name="Divide-and-Conquer Expansion Slideshow" data-exer-id="" alt="Divide-and-Conquer Expansion Slideshow" tabIndex="-1">
 <span class="jsavcounter"></span>
 <a class="jsavsettings" href="#">Settings</a>
 <div class="jsavcontrols"></div>
 <p class="jsavoutput jsavline"></p>
 <div class="jsavcanvas"></div>
 <div class="prof_indicators">
  <img id="ExpandRecurrenceCON_check_mark" class="prof_check_mark" src="_static/Images/green_check.png" alt="Proficient" />
  <span id="ExpandRecurrenceCON_cm_saving_msg" class="cm_saving_msg">Saving...</span>
  <span id="ExpandRecurrenceCON_cm_error_msg" class="cm_error_msg">
   <img id="ExpandRecurrenceCON_cm_warning_icon" class="cm_warning_icon" src="_static/Images/warning.png" alt="Error Saving" /><br />
   Server Error<br />
   <a href="#" class="resubmit_link">Resubmit</a>
  </span>
 </div>
</div>
<p></p>
<div class="topic">
<p class="topic-title">Example 3.19.4 </p>
<p>Our next example models the cost of the algorithm to build a heap.
You should recall that to build a <a class="reference internal" href="Heaps.html#heaps"><span class="std std-ref">heap</span></a>,
we first heapify the two subheaps, then push down the root to its
proper position.
The cost is:</p>
<div class="math notranslate nohighlight">
\[f(n) \leq 2f(n/2) + 2 \log n.\]</div>
<p>Let us find a closed form solution for this recurrence.
We can expand the recurrence a few times to see that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray*}
f(n) &amp;\leq&amp; 2f(n/2) + 2 \log n\\
&amp;\leq&amp; 2[2f(n/4) + 2 \log n/2] + 2 \log n\\
&amp;\leq&amp; 2[2(2f(n/8) + 2 \log n/4) + 2 \log n/2] + 2 \log n
\end{eqnarray*}\end{split}\]</div>
<p>We can deduce from this expansion that this recurrence is
equivalent to following summation and its derivation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray*}
f(n) &amp;\leq&amp; \sum_{i=0}^{\log n -1} 2^{i+1} \log(n/2^i)\\
&amp;=&amp; 2 \sum_{i=0}^{\log n -1} 2^i (\log n - i)\\
&amp;=&amp; 2 \log n \sum_{i=0}^{\log n -1} 2^i - 4 \sum_{i=0}^{\log n -1} i 2^{i-1}\\
&amp;=&amp; 2 n \log n - 2 \log n - 2 n \log n + 4n -4\\
&amp;=&amp; 4n - 2 \log n - 4.
\end{eqnarray*}\end{split}\]</div>
</div>
</div>
<div class="section" id="divide-and-conquer-recurrences">
<h3>3.<span class="section-number">18.1.3. </span>Divide-and-Conquer Recurrences<a class="headerlink" href="#divide-and-conquer-recurrences" title="Permalink to this headline">¶</a></h3>
<p>The third approach to solving recurrences is to take advantage of
known theorems that provide the solution for classes of recurrences.
Of particular practical use is a theorem that gives the
answer for a class known as <a class="reference internal" href="Glossary.html#term-divide-and-conquer-recurrences"><span class="xref std std-term">divide-and-conquer recurrences</span></a>.
These have the form</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = a{\bf T}(n/b) + cn^k; \quad {\bf T}(1) = c\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span>, and <span class="math notranslate nohighlight">\(k\)</span> are constants.
In general, this recurrence describes a problem of size <span class="math notranslate nohighlight">\(n\)</span>
divided into <span class="math notranslate nohighlight">\(a\)</span> subproblems of size <span class="math notranslate nohighlight">\(n/b\)</span>,
while <span class="math notranslate nohighlight">\(cn^k\)</span> is the amount of work necessary to combine the
partial solutions.
Mergesort is an example of a divide and conquer algorithm, and its
recurrence fits this form.
So does binary search.
We use the method of expanding recurrences to derive the general
solution for any divide and conquer recurrence, assuming that
<span class="math notranslate nohighlight">\(n = b^m\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray*}
{\bf T}(n) &amp; = &amp; a{\bf T}(n/b) + cn^k\\
  &amp; = &amp; a(a{\bf T}(n/b^2) + c(n/b)^k) + cn^k\\
  &amp; = &amp; a(a[a{\bf T}(n/b^3) + c(n/b^2)^k] + c(n/b)^k) + cn^k\\
  &amp; = &amp; a^m{\bf T}(1) + a^{m-1}c(n/b^{m-1})^k + \cdots + ac(n/b)^k + cn^k\\
  &amp; = &amp; a^mc + a^{m-1}c(n/b^{m-1})^k + \cdots + ac(n/b)^k + cn^k\\
  &amp; = &amp; c\sum_{i=0}^{m} a^{m-i} b^{ik}\\
  &amp; = &amp;ca^m\sum_{i=0}^{m} (b^k/a)^i.
\end{eqnarray*}\end{split}\]</div>
<p>Here is a more visual presentation of this same derivation.</p>
<div id="DandCRecurrenceCON" class="ssAV" data-points="0.0" data-threshold="1.0" data-type="ss" data-required="False" data-short-name="DandCRecurrenceCON" data-long-name="Divide-and-Conquer Expansion Slideshow2" data-exer-id="" alt="Divide-and-Conquer Expansion Slideshow2" tabIndex="-1">
 <span class="jsavcounter"></span>
 <a class="jsavsettings" href="#">Settings</a>
 <div class="jsavcontrols"></div>
 <p class="jsavoutput jsavline"></p>
 <div class="jsavcanvas"></div>
 <div class="prof_indicators">
  <img id="DandCRecurrenceCON_check_mark" class="prof_check_mark" src="_static/Images/green_check.png" alt="Proficient" />
  <span id="DandCRecurrenceCON_cm_saving_msg" class="cm_saving_msg">Saving...</span>
  <span id="DandCRecurrenceCON_cm_error_msg" class="cm_error_msg">
   <img id="DandCRecurrenceCON_cm_warning_icon" class="cm_warning_icon" src="_static/Images/warning.png" alt="Error Saving" /><br />
   Server Error<br />
   <a href="#" class="resubmit_link">Resubmit</a>
  </span>
 </div>
</div>
<p></p>
<p>So, we are left with this result:</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = ca^m\sum_{i=0}^{m} (b^k/a)^i.\]</div>
<p>At this point, it is useful to note that</p>
<div class="math notranslate nohighlight">
\[\begin{eqnarray}
\label{ThmEquiv}
a^m = a^{\log_bn} = n^{\log_ba}.
\end{eqnarray}\]</div>
<p>This gives us</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = c n^{\log_ba} \sum_{i=0}^{m} (b^k/a)^i.\]</div>
<p>The summation part of this equation is a geometric series whose sum
depends on the ratio <span class="math notranslate nohighlight">\(r = b^k/a\)</span>.
There are three cases.</p>
<ol class="arabic">
<li><p><span class="math notranslate nohighlight">\(r&lt;1\)</span>.
From Equation (4) of Module <a class="reference internal" href="Glossary.html#term-summation"><span class="xref std std-term">summation</span></a>,</p>
<div class="math notranslate nohighlight">
\[\sum_{i=0}^{m} r^i &lt; 1/(1-r),\ {\rm a~constant.}\]</div>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = \Theta(a^m) = \Theta(n^{log_ba}).\]</div>
</li>
<li><p><span class="math notranslate nohighlight">\(r=1\)</span>.
Because <span class="math notranslate nohighlight">\(r = b^k/a\)</span>, we know that <span class="math notranslate nohighlight">\(a = b^k\)</span>.
From the definition of logarithms it follows immediately that
<span class="math notranslate nohighlight">\(k = \log_b a\)</span>.
Also note that since we defined <span class="math notranslate nohighlight">\(n = b^m\)</span>,
then <span class="math notranslate nohighlight">\(m = \log_b n\)</span>.
Thus,</p>
<div class="math notranslate nohighlight">
\[\sum_{i=0}^{m} r^i = m + 1 = \log_bn + 1.\]</div>
<p>Because <span class="math notranslate nohighlight">\(a^m = n^{\log_b a} = n^k\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = \Theta(n^{\log_ba}\log_b n) = \Theta(n^k\log_b n).\]</div>
</li>
<li><p><span class="math notranslate nohighlight">\(r&gt;1\)</span>.
From Equation (5) of Module <a class="reference internal" href="Glossary.html#term-summation"><span class="xref std std-term">summation</span></a>,</p>
<div class="math notranslate nohighlight">
\[\sum_{i=0}^{m} r^i = \frac{r^{m+1} - 1}{r - 1} = \Theta(r^m).\]</div>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = \Theta(a^mr^m)
           = \Theta(a^m(b^k/a)^m)
           = \Theta(b^{km})
           = \Theta(n^k).\]</div>
</li>
</ol>
<p>We can summarize the above derivation as the following theorem,
sometimes referred to as the <a class="reference internal" href="Glossary.html#term-master-theorem"><span class="xref std std-term">Master Theorem</span></a>.</p>
<div class="topic" id="recurthm">
<p class="topic-title">Theorem 3.19.1  </p>
<p><strong>The Master Theorem:</strong> For any recurrence relation of the form
<span class="math notranslate nohighlight">\({\bf T}(n) = a{\bf T}(n/b) + cn^k, {\bf T}(1) = c\)</span>,
the following relationships hold.</p>
<div class="math notranslate nohighlight">
\[\begin{split}{\bf T}(n) = \left\{ \begin{array}{ll}
             \Theta(n^{\log_ba}) &amp; \mbox{if \(a &gt; b^k\)} \\
             \Theta(n^k\log_b n)   &amp; \mbox{if \(a = b^k\)} \\
             \Theta(n^k)         &amp; \mbox{if \(a &lt; b^k\).}
            \end{array}
   \right.\end{split}\]</div>
</div>
<p>This theorem may be applied whenever appropriate, rather than
re-deriving the solution for the recurrence.</p>
<div class="topic">
<p class="topic-title">Example 3.19.5 </p>
<p>Apply the Master Theorem to solve</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = 3{\bf T}(n/5) + 8n^2.\]</div>
<p>Because <span class="math notranslate nohighlight">\(a=3\)</span>, <span class="math notranslate nohighlight">\(b=5\)</span>, <span class="math notranslate nohighlight">\(c=8\)</span>, and <span class="math notranslate nohighlight">\(k=2\)</span>, we
find that <span class="math notranslate nohighlight">\(3&lt;5^2\)</span>.
Applying case (3) of the theorem, <span class="math notranslate nohighlight">\({\bf T}(n) = \Theta(n^2)\)</span>.</p>
</div>
<div class="topic">
<p class="topic-title">Example 3.19.6 </p>
<p>Use the Master Theorem to solve the recurrence relation
for Mergesort:</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = 2{\bf T}(n/2) + n; \quad {\bf T}(1) = 1.\]</div>
<p>Because <span class="math notranslate nohighlight">\(a=2\)</span>, <span class="math notranslate nohighlight">\(b=2\)</span>, <span class="math notranslate nohighlight">\(c=1\)</span>, and <span class="math notranslate nohighlight">\(k=1\)</span>,
we find that <span class="math notranslate nohighlight">\(2 = 2^1\)</span>.
Applying case (2) of the theorem,
<span class="math notranslate nohighlight">\({\bf T}(n) = \Theta(n \log n)\)</span>.</p>
</div>
</div>
<div class="section" id="average-case-analysis-of-quicksort">
<h3>3.<span class="section-number">18.1.4. </span>Average-Case Analysis of Quicksort<a class="headerlink" href="#average-case-analysis-of-quicksort" title="Permalink to this headline">¶</a></h3>
<p>In Module <a class="reference internal" href="Quicksort.html#quicksort"><span class="std std-ref">Quicksort</span></a>, we determined that
the average-case analysis of Quicksort had the following recurrence:</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = cn + \frac{1}{n}\sum_{k=0}^{n-1} [{\bf T}(k) +
 {\bf T}(n -1 - k)], \qquad {\bf T}(0) = {\bf T}(1) = c.\]</div>
<p>The <span class="math notranslate nohighlight">\(cn\)</span> term is an upper bound on the <cite>findpivot</cite> and
<cite>partition</cite> steps.
This equation comes from assuming that the partitioning element is
equally likely to occur in any position <span class="math notranslate nohighlight">\(k\)</span>.
It can be simplified by observing that the two
recurrence terms <span class="math notranslate nohighlight">\({\bf T}(k)\)</span> and <span class="math notranslate nohighlight">\({\bf T}(n - 1 - k)\)</span> are
equivalent, because one simply counts up from <span class="math notranslate nohighlight">\(T(0)\)</span> to
<span class="math notranslate nohighlight">\(T(n-1)\)</span> while the other counts down from <span class="math notranslate nohighlight">\(T(n-1)\)</span> to
<span class="math notranslate nohighlight">\(T(0)\)</span>.
This yields</p>
<div class="math notranslate nohighlight">
\[{\bf T}(n) = cn + \frac{2}{n}\sum_{k=0}^{n-1} {\bf T}(k).\]</div>
<p>This form is known as a <a class="reference internal" href="Glossary.html#term-recurrence-with-full-history"><span class="xref std std-term">recurrence with full history</span></a>.
The key to solving such a recurrence is to cancel out the summation
terms.
The shifting method for summations provides a way to do
this.
Multiply both sides by <span class="math notranslate nohighlight">\(n\)</span> and subtract the result from the
formula for <span class="math notranslate nohighlight">\(n{\bf T}(n+1)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray*}
n{\bf T}(n) &amp; = &amp; cn^2 + 2 \sum_{k=1}^{n-1} {\bf T}(k)\\
(n+1){\bf T}(n+1) &amp; = &amp; c(n+1)^2 + 2 \sum_{k=1}^{n} {\bf T}(k).
\end{eqnarray*}\end{split}\]</div>
<p>Subtracting <span class="math notranslate nohighlight">\(n{\bf T}(n)\)</span> from both sides yields:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray*}
(n+1){\bf T}(n+1) - n{\bf T}(n) &amp; = &amp; c(n+1)^2 - cn^2 + 2{\bf T}(n)\\
(n+1){\bf T}(n+1) - n{\bf T}(n) &amp; = &amp; c(2n+1) + 2{\bf T}(n)\\
(n+1){\bf T}(n+1) &amp; = &amp; c(2n+1) + (n+2){\bf T}(n)\\
{\bf T}(n+1) &amp; = &amp; \frac{c(2n+1)}{n+1} + \frac{n+2}{n+1}{\bf T}(n).
\end{eqnarray*}\end{split}\]</div>
<p>At this point, we have eliminated the summation and can now
use our normal methods for solving recurrences to get a closed-form
solution.
Note that <span class="math notranslate nohighlight">\(\frac{c(2n+1)}{n+1} &lt; 2c\)</span>, so we can simplify the
result.
Expanding the recurrence, we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray*}
{\bf T}(n+1) &amp; \leq &amp; 2c + \frac{n+2}{n+1} {\bf T}(n)\\
          &amp; = &amp; 2c + \frac{n+2}{n+1}\left (2c +
                     \frac{n+1}{n}{\bf T}(n-1)\right )\\
          &amp; = &amp; 2c + \frac{n+2}{n+1}\left (2c + \frac{n+1}{n}\left
                    (2c + \frac{n}{n-1}{\bf T}(n-2)\right )\right )\\
          &amp; = &amp; 2c + \frac{n+2}{n+1}\left (2c + \cdots +
                         \frac{4}{3}(2c + \frac{3}{2}{\bf T}(1))\right )\\
          &amp; = &amp; 2c\left (1 + \frac{n+2}{n+1}
                  + \frac{n+2}{n+1}\frac{n+1}{n} + \cdots
                  + \frac{n+2}{n+1}\frac{n+1}{n}\cdots\frac{3}{2}\right )\\
          &amp; = &amp; 2c\left (1 + (n+2)\left (\frac{1}{n+1}
                  + \frac{1}{n} + \cdots + \frac{1}{2}\right )\right )\\
          &amp; = &amp; 2c + 2c(n+2)\left ({\cal H}_{n+1} - 1\right )\\
\end{eqnarray*}\end{split}\]</div>
<p>for <span class="math notranslate nohighlight">\({\cal H}_{n+1}\)</span>, the Harmonic Series.
From Equation (10) of Module <a class="reference internal" href="Glossary.html#term-summation"><span class="xref std std-term">summation</span></a>,
<span class="math notranslate nohighlight">\({\cal H}_{n+1} = \Theta(\log n)\)</span>,
so the final solution is <span class="math notranslate nohighlight">\(\Theta(n \log n)\)</span>.</p>
<script type="text/javascript" src="../../../AV/SeniorAlgAnal/ExpandRecurrenceCON.js"></script>
<script type="text/javascript" src="../../../AV/SeniorAlgAnal/DandCRecurrenceCON.js"></script>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      <p><span class="email_div" style="display:inline;"><a id="contact_us" class="contact" style="float:left;color:blue;" rel="nofollow" href="mailto:">Contact Us |</a><a style="float:left;color:blue;" rel="nofollow" href="../../../lib/Privacy.html" target="_blank">| Privacy |</a> <a style="float:left;color:blue;" rel="nofollow" href="../../../lib/license.html" target="_blank">| License</a></span>&#160;&#160;
      
        «&#160;&#160;<a id="prevmod1" href="AdvSumm.html">3.<span class="section-number">17. </span>Summation Techniques (optional) (WORK IN PROGRESS)</a>
        &#160;&#160;::&#160;&#160;
        <a  class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a  id="nextmod1" href="AmortAnal.html">3.<span class="section-number">19. </span>Amortized Analysis (optional) (WORK IN PROGRESS)</a>&#160;&#160;»

</p>
      </div>
      <img style="float:right;" src="_static/nsf1.gif" height="62" width="62" alt="nsf"/>


    <div class="footer">
      <p>
        <span class="email_div" style="display:inline;">
          <a id="contact_us" class="contact" style="float:left;color:blue;" rel="nofollow" href="mailto:">Contact Us |</a>
          <a id="bugreport-link" style="float:left;color:blue;" class="bugreport-link" href="#">| Report a bug</a>
        </span>
      </p>
        &copy; Copyright 2016 by OpenDSA Project Contributors and distributed under an MIT license.
      Last updated on Dec 05, 2021.
      Created using <a target="_blank" href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.4.
    </div>
    
<div id="bugreport-box" class="bugreport-popup ">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close Window" /></a>
  <form method="post" class="report" action="https://#">
    <fieldset class="textbox">
      <div id="bug_error" class="error"></div>
      <label>
        <span>Summary*:</span>
        <input type="text" id="b_title" placeholder="Summary" />
      </label>

      <label class="os">
        <span>Operating system*:</span>
        <select id="b_os">
          <option value="windows">Windows</option>
          <option value="macos">Mac OS</option>
          <option value="linux">Linux</option>
          <option value="ios">iOS</option>
          <option value="android">Android</option>
          <option value="other">Other</option>
        </select>
      </label>

      <label class="browser">
        <span>Browser*:</span>
        <select id="b_browser">
          <option value="chrome">Chrome</option>
          <option value="safari">Safari</option>
          <option value="internetexplorer">Internet Explorer</option>
          <option value="opera">Opera</option>
          <option value="other">Other</option>
        </select>
      </label>

      <label class="description">
        <span>Description*:</span><br>
        <textarea id="b_description" rows="5" cols="25" placeholder="***BUG** Please enter: (1) a consice description of the problem. (2) steps to reproduce bug. (3) the version of your browser and operating system."></textarea>
      </label>

      <label class="screenshot">
        <span>Attach a screenshot (optional):</span>
        <input type="file" id="b_screenshot" accept="image/*" placeholder="Attach a screenshot (optional)">
      </label>

      <p>
        <input type="submit" id="bug-submit-button" value="Submit &rarr;"/>
      </p>
    </fieldset>
  </form>
</div>

  </body>
</html>