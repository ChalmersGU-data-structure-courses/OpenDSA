
<!DOCTYPE html>




<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4.11. Implementing Recursion &mdash; Data Structures and Algorithms</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/normalize.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/JSAV.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/odsaMOD-min.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/jquery.ui.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/odsaStyle-min.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/accessibility.css" type="text/css" />
    
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.4.1',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
      },
      "HTML-CSS": {
        scale: "80"
      }
    });
  </script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="index" title="Data Structures and Algorithms" href="index.html" />
    <link rel="next" title="12. Array-Based Queues" href="Queue.html" />
    <link rel="prev" title="10. Linked Stacks" href="StackLinked.html" />

  </head>

  <body>


      <div class="header">
        
  
      <script type="text/javascript" src="../../../lib/jquery.min.js"></script>
      <script type="text/javascript" src="../../../lib/jquery.migrate.min.js"></script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/localforage/1.9.0/localforage.min.js"></script>
      <script type="text/javascript" src="../../../lib/accessibility.js"></script>
    <script type="text/javascript" src="../../../lib/jquery.ui.min.js"></script>
    <script type="text/javascript" src="../../../lib/jquery.transit.js"></script>
    <script type="text/javascript" src="../../../lib/raphael.js"></script>
    <script type="text/javascript" src="../../../lib/JSAV-min.js"></script>
    <script type="text/javascript" src="_static/config.js"></script>
    <script type="text/javascript" src="../../../lib/timeme-min.js"></script>
    <script type="text/javascript" src="../../../lib/odsaUtils-min.js"></script>
    <script type="text/javascript" src="../../../lib/odsaMOD-min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
    <script type="text/javascript" src="https://d3js.org/d3-selection-multi.v1.min.js"></script>
    <script type="text/javascript" src="../../../lib/dataStructures.js"></script>
    <script type="text/javascript" src="../../../lib/conceptMap.js"></script>

        
<a id="username-link" style="float:right;color:red;margin:10px 20px auto; display: none" class="username-link" href="Gradebook.html"></a>
<a id="login-link" style="float:right;color:red;margin:10px 20px auto" class="login-link" href="#"><Macro 'login'></a>
<div id="login-box" class="login-popup">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close" /></a>
  <form method="post" class="signin" action="https://#">
    <fieldset class="textbox">
      <label class="username">
        <span>Username</span>
        <input id="username" value="" type="text" autocomplete="on" placeholder="Username" tabindex="1">
      </label>
      <label class="password">
        <span>Password</span>
        <input id="password" value="" type="password" placeholder="Password" tabindex="2">
        <span><a id="forgot" href="#">Forgot your password?</a></span>
      </label>

      <p>
        <input type="submit" id="login-submit-button" value="Sign in" tabindex="3" />
      </p>
      <p>
        <input type="button" id="register-button" value="Register" tabindex="4" />
      </p>
    </fieldset>
  </form>
</div>

        
<a id="registration-link" style="float:right;color:red;margin:10px 20px auto" class="registration-link" href="#">Register</a>
<div id="registration-box" class="registration-popup ">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close Window" /></a>
  <form method="post" class="signin" action="https://#">
    <fieldset class="textbox">
      <div id="register_error" class="error"></div>
      <label class="username">
        <span>Username:</span>
        <input type="text" id="user" placeholder="Username" />
      </label>

      <label class="password">
        <span>Password</span>
        <input id="pass" type="password" placeholder="Password" />
      </label>

      <label class="password">
        <span>Confirm Password</span>
        <input id="rpass" type="password" placeholder="Confirm Password" />
      </label>

      <label class="email">
        <span>Email:</span>
        <input type="text" id="email" placeholder="Email">
      </label>

      <p>
        <input type="submit" id="register-submit-button" value="Register &rarr;"/>
      </p>
    </fieldset>
  </form>
</div>
<img class="leftlogo" src="_static/OpenDSALogoT64.png" alt="Logo"/><div class="title-wrapper">
          <div class="title-inbetween" style="display: table-cell; vertical-align: middle;">
            <div class="title-content">
              <h1 class="heading" ><a href="index.html">
                <span>Data Structures and Algorithms</span></a></h1>
              <h2 class="heading" ><span>Chapter 4 Linear Structures</span></h2>
            </div>
          </div>
        </div>
      </div>
      <div class="topnav">
        <p>
            <a style="float:left;color:blue;" href="../source/StackRecur.rst.rst"
              target="_blank" rel="nofollow">Show Source | </a>&#160;&#160;
            <a class="abt" style="float:left;color:blue;" href="#" rel="nofollow">| About</a>&#160;&#160;

          
        «&#160;&#160;<a id="prevmod" href="StackLinked.html">4.<span class="section-number">10. </span>Linked Stacks</a>
        &#160;&#160;::&#160;&#160;
        <a  class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a  id="nextmod" href="Queue.html">4.<span class="section-number">12. </span>Array-Based Queues</a>&#160;&#160;»


        </p>
      </div>
       
      <div class="content">
        
  <script>ODSA.SETTINGS.MODULE_SECTIONS = ['call-stacks-for-implementing-recursion', 'towers-of-hanoi'];</script><script>ODSA.SETTINGS.DISP_MOD_COMP = true;ODSA.SETTINGS.MODULE_NAME = "StackRecur";ODSA.SETTINGS.MODULE_LONG_NAME = "Implementing Recursion";ODSA.SETTINGS.MODULE_CHAPTER = "Linear Structures"; ODSA.SETTINGS.BUILD_DATE = "2021-11-24 16:47:50"; ODSA.SETTINGS.BUILD_CMAP = true;JSAV_OPTIONS['lang']='en';JSAV_EXERCISE_OPTIONS['code']='pseudo';</script><div class="section" id="implementing-recursion">
<h1>4.<span class="section-number">11. </span>Implementing Recursion<a class="headerlink" href="#implementing-recursion" title="Permalink to this headline">¶</a></h1>
<p>WARNING! You should not read this section unless you are already
comfortable with implementing <a class="reference internal" href="Glossary.html#term-recursion"><span class="xref std std-term">recursive</span></a>
functions.
One of the biggest hang-ups for students learning recursion is too
much focus on the recursive “process”.
The right way to think about recursion is to just think about the
return value that the recursive call gives back.
Thinking about <em>how</em> that answer is computed just gets in the way of
understanding.
There are good reasons to understand how recursion is implemented,
but helping you to write recursive functions is not one of them.</p>
<div class="section" id="call-stacks-for-implementing-recursion">
<h2>4.<span class="section-number">11.1. </span>Call stacks for implementing recursion<a class="headerlink" href="#call-stacks-for-implementing-recursion" title="Permalink to this headline">¶</a></h2>
<p>Perhaps the most common computer application that uses
<a class="reference internal" href="StackArray.html#stackarray"><span class="std std-ref">stacks</span></a> is not even visible to its users.
This is the implementation of subroutine calls in most programming
language <a class="reference internal" href="Glossary.html#term-runtime-environment"><span class="xref std std-term">runtime environments</span></a>.
A subroutine call is normally implemented by <a class="reference internal" href="Glossary.html#term-push"><span class="xref std std-term">pushing</span></a>
necessary information about the subroutine (including the return
address, parameters, and local variables) onto a stack.
This information is called an <a class="reference internal" href="Glossary.html#term-activation-record"><span class="xref std std-term">activation record</span></a>.
Further subroutine calls add to the stack.
Each return from a subroutine <a class="reference internal" href="Glossary.html#term-pop"><span class="xref std std-term">pops</span></a> the top activation
record off the stack.
As an example, here is a recursive implementation for the factorial
function.</p>
<div id="Factorial_RFact_code"><ul><li><a href="#Factorial_RFact_code_Java_Generic">Java</a></li><li><a href="#Factorial_RFact_code_Python">Python</a></li></ul><div id="Factorial_RFact_code_Java_Generic"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Recursively compute and return n!</span>
<span class="kd">static</span> <span class="kt">long</span> <span class="nf">factorial_recursive</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Argument must be &gt;= 0&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Cannot handle larger values than 20!&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>  <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>   <span class="c1">// Base case: return base solution</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial_recursive</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>   <span class="c1">// Recursive call for n &gt; 1</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div id="Factorial_RFact_code_Python"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Recursively compute and return n!</span>
<span class="k">def</span> <span class="nf">factorial_recursive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Argument must be &gt;= 0&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>   <span class="c1"># Base case: return base solution</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial_recursive</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># Recursive call for n &gt; 1</span>
</pre></div>
</div>
</div></div><script>$(function() {$( "#Factorial_RFact_code" ).tabs();});</script><p>Here is an illustration for how the internal processing works.</p>
<div class="figure align-center" id="recurstack" style="width: 90%">
<a class="reference internal image-reference" href="_images/RecurSta.png"><img alt="Implementing recursion with a stack" src="_images/RecurSta.png" style="width: 500px;" /></a>
</div>
<p><span class="math notranslate nohighlight">\(\beta\)</span> values indicate the address of the program instruction
to return to after completing the current function call.
On each recursive function call to <code class="docutils literal notranslate"><span class="pre">fact</span></code>, both the return
address and the current value of <code class="docutils literal notranslate"><span class="pre">n</span></code> must be saved.
Each return from <code class="docutils literal notranslate"><span class="pre">fact</span></code> pops the top activation record off the
stack.</p>
<p>Consider what happens when we call <code class="docutils literal notranslate"><span class="pre">fact</span></code> with the value 4.
We use <span class="math notranslate nohighlight">\(\beta\)</span> to indicate the address of the program
instruction where the call to <code class="docutils literal notranslate"><span class="pre">fact</span></code> is made.
Thus, the stack must first store the address <span class="math notranslate nohighlight">\(\beta\)</span>, and the
value 4 is passed to <code class="docutils literal notranslate"><span class="pre">fact</span></code>.
Next, a recursive call to <code class="docutils literal notranslate"><span class="pre">fact</span></code> is made, this time with value 3.
We will name the program address from which the call is
made <span class="math notranslate nohighlight">\(\beta_1\)</span>.
The address <span class="math notranslate nohighlight">\(\beta_1\)</span>, along with the current value for
<span class="math notranslate nohighlight">\(n\)</span> (which is 4), is saved on the stack.
Function <code class="docutils literal notranslate"><span class="pre">fact</span></code> is invoked with input parameter 3.</p>
<p>In similar manner, another recursive call is made with input
parameter 2, requiring that the address from which the call is made
(say <span class="math notranslate nohighlight">\(\beta_2\)</span>) and the current value for <span class="math notranslate nohighlight">\(n\)</span> (which is 3)
are stored on the stack.
A final recursive call with input parameter 1 is made, requiring that
the stack store the calling address (say <span class="math notranslate nohighlight">\(\beta_3\)</span>) and current
value (which is 2).</p>
<p>At this point, we have reached the base case for <code class="docutils literal notranslate"><span class="pre">fact</span></code>, and so
the recursion begins to unwind.
Each return from <code class="docutils literal notranslate"><span class="pre">fact</span></code> involves popping the stored value for
<span class="math notranslate nohighlight">\(n\)</span> from the stack, along with the return address from the
function call.
The return value for <code class="docutils literal notranslate"><span class="pre">fact</span></code> is multiplied by the restored value
for <span class="math notranslate nohighlight">\(n\)</span>, and the result is returned.</p>
<p>Because an activation record must be created and placed onto the stack
for each subroutine call, making subroutine calls is a relatively
expensive operation.
While recursion is often used to make implementation easy and clear,
sometimes you might want to eliminate the overhead imposed by the
recursive function calls.
In some cases, such as the factorial function above,
recursion can easily be replaced by iteration.</p>
<div class="topic" id="stackfact">
<p class="topic-title">Example 4.12.1 </p>
<p>As a simple example of replacing recursion with a stack, consider
the following non-recursive version of the factorial function.</p>
<div id="Factorial_SFact_code"><ul><li><a href="#Factorial_SFact_code_Java_Generic">Java</a></li><li><a href="#Factorial_SFact_code_Python">Python</a></li></ul><div id="Factorial_SFact_code_Java_Generic"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Return n!</span>
<span class="kd">static</span> <span class="kt">long</span> <span class="nf">factorial_stack</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Argument must be &gt;= 0&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Cannot handle larger values than 20!&quot;</span><span class="p">);</span>
    <span class="n">Stack</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedStack</span><span class="o">&lt;&gt;</span><span class="p">();</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">S</span><span class="p">.</span><span class="na">push</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
        <span class="n">n</span><span class="o">--</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="n">S</span><span class="p">.</span><span class="na">pop</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div id="Factorial_SFact_code_Python"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Return n!</span>
<span class="k">def</span> <span class="nf">factorial_stack</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Argument must be &gt;= 0&quot;</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">LinkedStack</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">S</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">S</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="n">S</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div></div><script>$(function() {$( "#Factorial_SFact_code" ).tabs();});</script><p>Here, we simply push successively smaller values of <span class="math notranslate nohighlight">\(n\)</span> onto
the stack until the base case is reached, then repeatedly pop off
the stored values and multiply them into the result.</p>
</div>
<p>An iterative form of the factorial function is both
simpler and faster than the version shown in the example.
But it is not always possible to replace recursion with iteration.
Recursion, or some imitation of it, is necessary when implementing
algorithms that require multiple branching such as in the Towers of
Hanoi algorithm, or when
<a class="reference internal" href="BinaryTreeTraversal.html#binarytreetraversal"><span class="std std-ref">traversing a binary tree</span></a>.
The <a class="reference internal" href="Mergesort.html#mergesort"><span class="std std-ref">Mergesort</span></a> and
<a class="reference internal" href="Quicksort.html#quicksort"><span class="std std-ref">Quicksort</span></a> sorting algorithms
also require recursion.</p>
<p>Fortunately, it is always possible to imitate recursion with a stack.
Recursive algorithms lend themselves to efficient implementation with
a stack when the amount of information needed to describe a
sub-problem is small.
For example, <a class="reference internal" href="Quicksort.html#quicksort"><span class="std std-ref">Quicksort</span></a> can effectively
use a stack to replace its recursion since only bounds information for
the subarray to be processed needs to be saved.</p>
<p>Let us now turn to a non-recursive version of the Towers of
Hanoi function, which cannot be done iteratively.</p>
</div>
<div class="section" id="towers-of-hanoi">
<h2>4.<span class="section-number">11.2. </span>Towers of Hanoi<a class="headerlink" href="#towers-of-hanoi" title="Permalink to this headline">¶</a></h2>
<p>Here is a recursive implementation for Towers of Hanoi.</p>
<div id="TowersOfHanoi_TOH_code"><ul><li><a href="#TowersOfHanoi_TOH_code_Java_Generic">Java</a></li><li><a href="#TowersOfHanoi_TOH_code_Python">Python</a></li></ul><div id="TowersOfHanoi_TOH_code_Java_Generic"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Compute the moves to solve a Tower of Hanoi puzzle.</span>
<span class="c1">// Function move does (or prints) the actual move of a disk</span>
<span class="c1">// from one pole to another.</span>
<span class="c1">//  - n: The number of disks</span>
<span class="c1">//  - start: The start pole</span>
<span class="c1">//  - goal: The goal pole</span>
<span class="c1">//  - temp: The other pole</span>
<span class="kd">static</span> <span class="kt">void</span> <span class="nf">TOH_recursive</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">start</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">goal</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">temp</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>                              <span class="c1">// Base case</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="n">TOH_recursive</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">goal</span><span class="p">);</span>   <span class="c1">// Recursive call: n-1 rings</span>
    <span class="n">move</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">);</span>                       <span class="c1">// Move bottom disk to goal</span>
    <span class="n">TOH_recursive</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">start</span><span class="p">);</span>   <span class="c1">// Recursive call: n-1 rings</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div id="TowersOfHanoi_TOH_code_Python"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the moves to solve a Tower of Hanoi puzzle.</span>
<span class="c1"># Function move does (or prints) the actual move of a disk</span>
<span class="c1"># from one pole to another.</span>
<span class="c1">#  - n: The number of disks</span>
<span class="c1">#  - start: The start pole</span>
<span class="c1">#  - goal: The goal pole</span>
<span class="c1">#  - temp: The other pole</span>
<span class="k">def</span> <span class="nf">TOH_recursive</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>                             <span class="c1"># Base case</span>
        <span class="k">return</span>
    <span class="n">TOH_recursive</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">goal</span><span class="p">)</span>  <span class="c1"># Recursive call: n-1 rings</span>
    <span class="n">move</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">)</span>                      <span class="c1"># Move bottom disk to goal</span>
    <span class="n">TOH_recursive</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>  <span class="c1"># Recursive call: n-1 rings</span>
</pre></div>
</div>
</div></div><script>$(function() {$( "#TowersOfHanoi_TOH_code" ).tabs();});</script><p><code class="docutils literal notranslate"><span class="pre">TOH</span></code> makes two recursive calls:
one to move <span class="math notranslate nohighlight">\(n-1\)</span> rings off the bottom ring, and another to
move these <span class="math notranslate nohighlight">\(n-1\)</span> rings back to the goal pole.
We can eliminate the recursion by using a stack to store a
representation of the three operations that <code class="docutils literal notranslate"><span class="pre">TOH</span></code> must perform:
two recursive calls and a move operation.
To do so, we must first come up with a representation of the
various operations, implemented as a class whose objects will be
stored on the stack.</p>
<div id="TowersOfHanoi_TOHstack_code"><ul><li><a href="#TowersOfHanoi_TOHstack_code_Java_Generic">Java</a></li><li><a href="#TowersOfHanoi_TOHstack_code_Python">Python</a></li></ul><div id="TowersOfHanoi_TOHstack_code_Java_Generic"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">static</span> <span class="kt">void</span> <span class="nf">TOH_stack</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">start</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">goal</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">temp</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Make a stack just big enough</span>
    <span class="n">Stack</span><span class="o">&lt;</span><span class="n">TOH_object</span><span class="o">&gt;</span> <span class="n">S</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedStack</span><span class="o">&lt;&gt;</span><span class="p">();</span>
    <span class="n">S</span><span class="p">.</span><span class="na">push</span><span class="p">(</span><span class="k">new</span> <span class="n">TOH_object</span><span class="p">(</span><span class="n">TOH</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">temp</span><span class="p">));</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">TOH_object</span> <span class="n">it</span> <span class="o">=</span> <span class="p">(</span><span class="n">TOH_object</span><span class="p">)</span> <span class="n">S</span><span class="p">.</span><span class="na">pop</span><span class="p">();</span>  <span class="c1">// Get next task</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="na">op</span> <span class="o">==</span> <span class="n">MOVE</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">move</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="na">start</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">goal</span><span class="p">);</span>       <span class="c1">// Do a move</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="na">num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>         <span class="c1">// Imitate TOH recursive solution (in reverse)</span>
            <span class="n">S</span><span class="p">.</span><span class="na">push</span><span class="p">(</span><span class="k">new</span> <span class="n">TOH_object</span><span class="p">(</span><span class="n">TOH</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">num</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">temp</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">goal</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">start</span><span class="p">));</span>
            <span class="n">S</span><span class="p">.</span><span class="na">push</span><span class="p">(</span><span class="k">new</span> <span class="n">TOH_object</span><span class="p">(</span><span class="n">MOVE</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">start</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">goal</span><span class="p">));</span>  <span class="c1">// A move to do</span>
            <span class="n">S</span><span class="p">.</span><span class="na">push</span><span class="p">(</span><span class="k">new</span> <span class="n">TOH_object</span><span class="p">(</span><span class="n">TOH</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">num</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">start</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">temp</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="na">goal</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">static</span> <span class="kd">class</span> <span class="nc">TOH_object</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">op</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">num</span><span class="p">;</span>
    <span class="n">Pole</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">temp</span><span class="p">;</span>
    <span class="c1">// Recursive call operation</span>
    <span class="n">TOH_object</span><span class="p">(</span><span class="kt">int</span> <span class="n">o</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">s</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">g</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">o</span><span class="p">;</span> <span class="n">num</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">start</span> <span class="o">=</span> <span class="n">s</span><span class="p">;</span> <span class="n">goal</span> <span class="o">=</span> <span class="n">g</span><span class="p">;</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// MOVE operation</span>
    <span class="n">TOH_object</span><span class="p">(</span><span class="kt">int</span> <span class="n">o</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">s</span><span class="p">,</span> <span class="n">Pole</span> <span class="n">g</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">o</span><span class="p">;</span> <span class="n">start</span> <span class="o">=</span> <span class="n">s</span><span class="p">;</span> <span class="n">goal</span> <span class="o">=</span> <span class="n">g</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div id="TowersOfHanoi_TOHstack_code_Python"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">TOH_stack</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">LinkedStack</span><span class="p">()</span>
    <span class="n">S</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">TOH_object</span><span class="p">(</span><span class="n">TOH</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">temp</span><span class="p">))</span>
    <span class="k">while</span> <span class="n">S</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">it</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>         <span class="c1"># Get next task</span>
        <span class="k">if</span> <span class="n">it</span><span class="o">.</span><span class="n">op</span> <span class="o">==</span> <span class="n">MOVE</span><span class="p">:</span>    <span class="c1"># Do a move</span>
            <span class="n">move</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">goal</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">it</span><span class="o">.</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>     <span class="c1"># Imitate TOH recursive solution (in reverse)</span>
            <span class="n">S</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">TOH_object</span><span class="p">(</span><span class="n">TOH</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">num</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">goal</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">start</span><span class="p">));</span>
            <span class="n">S</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">TOH_object</span><span class="p">(</span><span class="n">MOVE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">goal</span><span class="p">));</span>   <span class="c1"># A move to do</span>
            <span class="n">S</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">TOH_object</span><span class="p">(</span><span class="n">TOH</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">num</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">goal</span><span class="p">));</span>

<span class="k">class</span> <span class="nc">TOH_object</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">o</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">goal</span> <span class="o">=</span> <span class="n">g</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="n">t</span>
</pre></div>
</div>
</div></div><script>$(function() {$( "#TowersOfHanoi_TOHstack_code" ).tabs();});</script><p>We first enumerate the possible operations MOVE and TOH, to
indicate calls to the <code class="docutils literal notranslate"><span class="pre">move</span></code> function
and recursive calls to <code class="docutils literal notranslate"><span class="pre">TOH</span></code>, respectively.
Class <code class="docutils literal notranslate"><span class="pre">TOH_object</span></code> stores five values: an operation value
(indicating either a MOVE or a new TOH operation), the number of
rings, and the three poles.
Note that the move operation actually needs only to store
information about two poles.
Thus, there are two constructors: one to store the state when
imitating a recursive call, and one to store the state for a move
operation.</p>
<p>An array-based stack is used because we know that the stack
will need to store exactly <span class="math notranslate nohighlight">\(2n+1\)</span> elements.
The new version of <code class="docutils literal notranslate"><span class="pre">TOH</span></code> begins by placing on the stack a
description of the initial problem for <span class="math notranslate nohighlight">\(n\)</span> rings.
The rest of the function is simply a <code class="docutils literal notranslate"><span class="pre">while</span></code> loop that pops the
stack and executes the appropriate operation.
In the case of a <code class="docutils literal notranslate"><span class="pre">TOH</span></code> operation (for <span class="math notranslate nohighlight">\(n&gt;0\)</span>), we store on
the stack representations for the three operations executed by the
recursive version.
However, these operations must be placed on the stack in reverse
order, so that they will be popped off in the correct order.</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      <p><span class="email_div" style="display:inline;"><a id="contact_us" class="contact" style="float:left;color:blue;" rel="nofollow" href="mailto:">Contact Us |</a><a style="float:left;color:blue;" rel="nofollow" href="../../../lib/Privacy.html" target="_blank">| Privacy |</a> <a style="float:left;color:blue;" rel="nofollow" href="../../../lib/license.html" target="_blank">| License</a></span>&#160;&#160;
      
        «&#160;&#160;<a id="prevmod1" href="StackLinked.html">4.<span class="section-number">10. </span>Linked Stacks</a>
        &#160;&#160;::&#160;&#160;
        <a  class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a  id="nextmod1" href="Queue.html">4.<span class="section-number">12. </span>Array-Based Queues</a>&#160;&#160;»

</p>
      </div>
      <img style="float:right;" src="_static/nsf1.gif" height="62" width="62" alt="nsf"/>


    <div class="footer">
      <p>
        <span class="email_div" style="display:inline;">
          <a id="contact_us" class="contact" style="float:left;color:blue;" rel="nofollow" href="mailto:">Contact Us |</a>
          <a id="bugreport-link" style="float:left;color:blue;" class="bugreport-link" href="#">| Report a bug</a>
        </span>
      </p>
        &copy; Copyright 2016 by OpenDSA Project Contributors and distributed under an MIT license.
      Last updated on Nov 24, 2021.
      Created using <a target="_blank" href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.4.
    </div>
    
<div id="bugreport-box" class="bugreport-popup ">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close Window" /></a>
  <form method="post" class="report" action="https://#">
    <fieldset class="textbox">
      <div id="bug_error" class="error"></div>
      <label>
        <span>Summary*:</span>
        <input type="text" id="b_title" placeholder="Summary" />
      </label>

      <label class="os">
        <span>Operating system*:</span>
        <select id="b_os">
          <option value="windows">Windows</option>
          <option value="macos">Mac OS</option>
          <option value="linux">Linux</option>
          <option value="ios">iOS</option>
          <option value="android">Android</option>
          <option value="other">Other</option>
        </select>
      </label>

      <label class="browser">
        <span>Browser*:</span>
        <select id="b_browser">
          <option value="chrome">Chrome</option>
          <option value="safari">Safari</option>
          <option value="internetexplorer">Internet Explorer</option>
          <option value="opera">Opera</option>
          <option value="other">Other</option>
        </select>
      </label>

      <label class="description">
        <span>Description*:</span><br>
        <textarea id="b_description" rows="5" cols="25" placeholder="***BUG** Please enter: (1) a consice description of the problem. (2) steps to reproduce bug. (3) the version of your browser and operating system."></textarea>
      </label>

      <label class="screenshot">
        <span>Attach a screenshot (optional):</span>
        <input type="file" id="b_screenshot" accept="image/*" placeholder="Attach a screenshot (optional)">
      </label>

      <p>
        <input type="submit" id="bug-submit-button" value="Submit &rarr;"/>
      </p>
    </fieldset>
  </form>
</div>

  </body>
</html>