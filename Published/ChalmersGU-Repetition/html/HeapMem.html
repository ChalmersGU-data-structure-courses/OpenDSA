
<!DOCTYPE html>




<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2.6. Heap Memory &mdash; Programming Basics: Background and Repetition</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/normalize.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/JSAV.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/odsaMOD-min.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/jquery.ui.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/odsaStyle-min.css" type="text/css" />
    <link rel="stylesheet" href="../../../lib/accessibility.css" type="text/css" />
    
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.4.1',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
      },
      "HTML-CSS": {
        scale: "80"
      }
    });
  </script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="index" title="Programming Basics: Background and Repetition" href="index.html" />
    <link rel="next" title="7. Link Nodes" href="Links1.html" />
    <link rel="prev" title="5. Local Memory" href="LocalMem.html" />

  </head>

  <body>


      <div class="header">
        
  
      <script type="text/javascript" src="../../../lib/jquery.min.js"></script>
      <script type="text/javascript" src="../../../lib/jquery.migrate.min.js"></script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/localforage/1.9.0/localforage.min.js"></script>
      <script type="text/javascript" src="../../../lib/accessibility.js"></script>
    <script type="text/javascript" src="../../../lib/jquery.ui.min.js"></script>
    <script type="text/javascript" src="../../../lib/jquery.transit.js"></script>
    <script type="text/javascript" src="../../../lib/raphael.js"></script>
    <script type="text/javascript" src="../../../lib/JSAV-min.js"></script>
    <script type="text/javascript" src="_static/config.js"></script>
    <script type="text/javascript" src="../../../lib/timeme-min.js"></script>
    <script type="text/javascript" src="../../../lib/odsaUtils-min.js"></script>
    <script type="text/javascript" src="../../../lib/odsaMOD-min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
    <script type="text/javascript" src="https://d3js.org/d3-selection-multi.v1.min.js"></script>
    <script type="text/javascript" src="../../../lib/dataStructures.js"></script>
    <script type="text/javascript" src="../../../lib/conceptMap.js"></script>

        
<a id="username-link" style="float:right;color:red;margin:10px 20px auto; display: none" class="username-link" href="Gradebook.html"></a>
<a id="login-link" style="float:right;color:red;margin:10px 20px auto" class="login-link" href="#"><Macro 'login'></a>
<div id="login-box" class="login-popup">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close" /></a>
  <form method="post" class="signin" action="https://#">
    <fieldset class="textbox">
      <label class="username">
        <span>Username</span>
        <input id="username" value="" type="text" autocomplete="on" placeholder="Username" tabindex="1">
      </label>
      <label class="password">
        <span>Password</span>
        <input id="password" value="" type="password" placeholder="Password" tabindex="2">
        <span><a id="forgot" href="#">Forgot your password?</a></span>
      </label>

      <p>
        <input type="submit" id="login-submit-button" value="Sign in" tabindex="3" />
      </p>
      <p>
        <input type="button" id="register-button" value="Register" tabindex="4" />
      </p>
    </fieldset>
  </form>
</div>

        
<a id="registration-link" style="float:right;color:red;margin:10px 20px auto" class="registration-link" href="#">Register</a>
<div id="registration-box" class="registration-popup ">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close Window" /></a>
  <form method="post" class="signin" action="https://#">
    <fieldset class="textbox">
      <div id="register_error" class="error"></div>
      <label class="username">
        <span>Username:</span>
        <input type="text" id="user" placeholder="Username" />
      </label>

      <label class="password">
        <span>Password</span>
        <input id="pass" type="password" placeholder="Password" />
      </label>

      <label class="password">
        <span>Confirm Password</span>
        <input id="rpass" type="password" placeholder="Confirm Password" />
      </label>

      <label class="email">
        <span>Email:</span>
        <input type="text" id="email" placeholder="Email">
      </label>

      <p>
        <input type="submit" id="register-submit-button" value="Register &rarr;"/>
      </p>
    </fieldset>
  </form>
</div>
<img class="leftlogo" src="_static/OpenDSALogoT64.png" alt="Logo"/><div class="title-wrapper">
          <div class="title-inbetween" style="display: table-cell; vertical-align: middle;">
            <div class="title-content">
              <h1 class="heading" ><a href="index.html">
                <span>Programming Basics: Background and Repetition</span></a></h1>
              <h2 class="heading" ><span>Chapter 2 References, repetition</span></h2>
            </div>
          </div>
        </div>
      </div>
      <div class="topnav">
        <p>
            <a style="float:left;color:blue;" href="../source/HeapMem.rst.rst"
              target="_blank" rel="nofollow">Show Source | </a>&#160;&#160;
            <a class="abt" style="float:left;color:blue;" href="#" rel="nofollow">| About</a>&#160;&#160;

          
        «&#160;&#160;<a id="prevmod" href="LocalMem.html">2.<span class="section-number">5. </span>Local Memory</a>
        &#160;&#160;::&#160;&#160;
        <a  class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a  id="nextmod" href="Links1.html">2.<span class="section-number">7. </span>Link Nodes</a>&#160;&#160;»


        </p>
      </div>
       
      <div class="content">
        
  <script>ODSA.SETTINGS.MODULE_SECTIONS = ['allocation', 'deallocation', 'programming-the-heap', 'a-heap-example', 'arrays'];</script><script>ODSA.SETTINGS.DISP_MOD_COMP = true;ODSA.SETTINGS.MODULE_NAME = "HeapMem";ODSA.SETTINGS.MODULE_LONG_NAME = "Heap Memory";ODSA.SETTINGS.MODULE_CHAPTER = "References, repetition"; ODSA.SETTINGS.BUILD_DATE = "2021-11-24 14:11:56"; ODSA.SETTINGS.BUILD_CMAP = true;JSAV_OPTIONS['lang']='en';JSAV_EXERCISE_OPTIONS['code']='java';</script><link href="../../../AV/Pointers/garbageDisposalCON.css" rel="stylesheet" type="text/css" />
<link href="../../../AV/Pointers/LocalHeapaloc.css" rel="stylesheet" type="text/css" />
<link href="../../../AV/Pointers/LocalHeapdealoc.css" rel="stylesheet" type="text/css" />
<link href="../../../AV/Pointers/LocalHeapintptr42.css" rel="stylesheet" type="text/css" />
<div class="section" id="heap-memory">
<h1>2.<span class="section-number">6. </span>Heap Memory<a class="headerlink" href="#heap-memory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>2.<span class="section-number">6.1. </span>Heap Memory<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>“Heap” memory, also known as “dynamic” memory, is an alternative to
local stack memory.
<a class="reference internal" href="LocalMem.html#localmem"><span class="std std-ref">Local memory</span></a> is quite automatic.
Local variables are allocated automatically when a function is called,
and they are deallocated automatically when the function exits.
Heap memory is different in every way.
The programmer explicitly requests that space be allocated,
using the <code class="docutils literal notranslate"><span class="pre">new</span></code> operator in Java or C++.
This memory “block” will be of a particular size,
ususally determined automatically from the size of the object being
created.
That memory block (your object) continues to be allocated
until something happens that makes it go away.
In some languages (noteably, C and C++),
an object in heap memory <strong>only</strong> goes away when the programmer explicitly
requests that it be deallocated.
So the programmer has much greater control of memory, but with greater
responsibility since the memory must now be actively managed.
Dropping all references to a memory location without deallocating it
is a signficant source of errors in C/C++, and this is so common that
it has a name: <a class="reference internal" href="Glossary.html#term-memory-leak"><span class="xref std std-term">memory leak</span></a>.
(In fact, many commercial programs implemented in C++ have memory
leaks, that will eventually make them crash after being used for a
long time.)
Java removes this source of errors by handling memory deallocation
automatically, using <a class="reference internal" href="Glossary.html#term-garbage-collection"><span class="xref std std-term">garbage collection</span></a>.
The downside is that garbage collection is a slow process that happens
at unpredictable times.</p>
<p>The advantages of heap memory are:</p>
<ul class="simple">
<li><p><strong>Lifetime</strong>. Because the programmer now controls exactly when
memory is allocated, it is possible to build a data structure in
memory, and return that data structure to the caller.
This was never possible with local memory, which was automatically
deallocated when the function exited.</p></li>
<li><p><strong>Size</strong>. The size of allocated memory can be controlled with more
detail.
For example, a string buffer can be allocated at run-time that is
exactly the right size to hold a particular string.
With local memory, the code is more likely to declare a buffer of
size 1000 and hope for the best.
(See the StringCopy() example below.)</p></li>
</ul>
<p>The disadvantages of heap memory are:</p>
<ul class="simple">
<li><p><strong>More Work</strong>. Heap allocation needs to arranged for explicitly in
the code, which is just more work.</p></li>
<li><p><strong>More Bugs</strong>. Because it’s now done explicitly in the code,
on occasion the allocation will be done incorrectly leading to
memory bugs.
Local memory is constrained, but at least it’s never <em>wrong</em>.</p></li>
</ul>
<p>Nonetheless, there are many problems that can only be solved with heap
memory, so that’s the way it has to be.</p>
<p>The following are some important points about Garbage Collection.</p>
<ul class="simple">
<li><p>Garbage collection is a mechanism that is invoked by the Java
Virtual Machine to get ride of the unused heap memory objects.
It removes every object that is not being used anymore by the
running Java program.
The result of this process is freeing up the unused memory so other
new objects can use that piece of memory.</p></li>
<li><p>In other programming languages like C and C++, it is the
responsibility of the programmer to take care of freeing up the
memory from unused objects and arrays.
Doing so consumes programmer’s time and increases code complexity.
On the other hand, garbage collection makes programming easier
by taking care of the memory management for the programmer.</p></li>
<li><p>Before removing an object from memory, garbage collection invokes the
finalize() method of that object and gives an opportunity to perform
any sort of cleanup required.
If the programmer does not override this method,
the default finializer method will be invoked
(the method defined in the <code class="docutils literal notranslate"><span class="pre">Object</span></code> class).</p></li>
<li><p>The Java Virtual Machine invokes garbage collection based on the
size of the dynamically allocated memory from the heap.
Garbage collection is <strong>slow</strong>, and hard to predict.
This can be a problem for programs that have real-time performance
constraints.</p></li>
</ul>
<p>The following are some cases that make an object subject to be removed
from heap memory by garbage collection:</p>
<ol class="arabic">
<li><p>When the programmer changes all references to an object to something
else.</p></li>
<li><p>If the object is defined inside a block of code, and all references
to that object are local.
When excecution of that block is complete, the local variables are
destroyed automatically, leaving the object in heap memory without
any references. (So this is really a special case of rule (1).)
Here is an example</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">test</span><span class="p">(</span><span class="kt">boolean</span> <span class="n">found</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">found</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// employee1 is a variable local to this if statement</span>
    <span class="c1">// but the Employee object is in heap memory.</span>
    <span class="n">Employee</span> <span class="n">employee1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Employee</span><span class="p">(</span><span class="s">&quot;John&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
    <span class="c1">// We can do things here with employee1, and its associated object</span>
    <span class="n">Printout</span><span class="p">(</span><span class="n">employee1</span><span class="p">.</span><span class="na">name</span><span class="p">());</span>
  <span class="p">}</span>

  <span class="c1">// At this point, the only reference to the created object is out of scope</span>
  <span class="c1">// since employee1 was local to the if statement block.</span>
  <span class="c1">// So the Employee object will be eligible for garbage collection.</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Assume an object <code class="docutils literal notranslate"><span class="pre">A</span></code> contains a reference to another object
<code class="docutils literal notranslate"><span class="pre">B</span></code>, and <code class="docutils literal notranslate"><span class="pre">A</span></code> contains the only such reference to <code class="docutils literal notranslate"><span class="pre">B</span></code>.
Object <code class="docutils literal notranslate"><span class="pre">B</span></code> will be eligible for garbage collection if <code class="docutils literal notranslate"><span class="pre">A</span></code> is
also eligible for garbage collection.
Here is an example.</p></li>
</ol>
<blockquote>
<div><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Date class to represent dates</span>
<span class="kd">class</span> <span class="nc">Date</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">day</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">month</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">year</span><span class="p">;</span>

  <span class="c1">// Date constructor</span>
  <span class="kd">public</span> <span class="nf">Date</span><span class="p">(</span><span class="kt">int</span> <span class="n">d</span><span class="p">,</span> <span class="kt">int</span> <span class="n">m</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">day</span> <span class="o">=</span> <span class="n">d</span><span class="p">;</span> <span class="n">month</span> <span class="o">=</span> <span class="n">m</span><span class="p">;</span> <span class="n">year</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// An Employee class that includes a Date</span>
<span class="kd">class</span> <span class="nc">Employee</span> <span class="p">{</span>
  <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
  <span class="n">Date</span> <span class="n">dateOfBirth</span><span class="p">;</span>

  <span class="c1">// Employee constructor to initialize both name and date</span>
  <span class="kd">public</span> <span class="nf">Employee</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span> <span class="p">,</span> <span class="kt">int</span> <span class="n">d</span><span class="p">,</span> <span class="kt">int</span> <span class="n">m</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
    <span class="n">dateOfBirth</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Date</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Now let&#39;s test this code</span>
<span class="kd">class</span> <span class="nc">Test</span> <span class="p">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Employee</span> <span class="n">empPtr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Employee</span><span class="p">(</span><span class="s">&quot;Sam&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1983</span><span class="p">);</span>
    <span class="c1">// Now empPtr references an object that contains a reference to a Date object</span>

    <span class="n">empPtr</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// Now the Employee object is eligible for garbage collection.</span>
    <span class="c1">// So its Date object will also be eligible for garbage collection</span>
    <span class="c1">// because nothing else points to it.</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div id="garbageDisposalCON" class="ssAV" data-points="0.0" data-threshold="1.0" data-type="ss" data-required="False" data-short-name="garbageDisposalCON" data-long-name="garbageDisposalCON" data-exer-id="" alt="garbageDisposalCON" tabIndex="-1">
 <span class="jsavcounter"></span>
 <a class="jsavsettings" href="#">Settings</a>
 <div class="jsavcontrols"></div>
 <p class="jsavoutput jsavline"></p>
 <div class="jsavcanvas"></div>
 <div class="prof_indicators">
  <img id="garbageDisposalCON_check_mark" class="prof_check_mark" src="_static/Images/green_check.png" alt="Proficient" />
  <span id="garbageDisposalCON_cm_saving_msg" class="cm_saving_msg">Saving...</span>
  <span id="garbageDisposalCON_cm_error_msg" class="cm_error_msg">
   <img id="garbageDisposalCON_cm_warning_icon" class="cm_warning_icon" src="_static/Images/warning.png" alt="Error Saving" /><br />
   Server Error<br />
   <a href="#" class="resubmit_link">Resubmit</a>
  </span>
 </div>
</div>
<p></p>
<p>Before seeing the exact details, let’s look at a rough example of
allocation and deallocation in the heap.</p>
<div class="section" id="allocation">
<h3>2.<span class="section-number">6.1.1. </span>Allocation<a class="headerlink" href="#allocation" title="Permalink to this headline">¶</a></h3>
<p>The heap is a large area of memory available for use by the program.
The program can request areas, or “blocks”, of memory for its use
within the heap.
In order to allocate a block of some size, the program makes an
explicit request by calling the heap <a class="reference internal" href="Glossary.html#term-allocation"><span class="xref std std-term">allocation</span></a> operation.
In Java or C++, this is the <code class="docutils literal notranslate"><span class="pre">new</span></code> operator.
The allocation function reserves a block of memory of the requested
size in the heap (usually, the size of the object that you want) and
returns a refernece to it.
Suppose a program makes three allocation requests to allocate memory
to hold three separate GIF images in the heap, each of which takes
1024 bytes of memory.
After the three allocation requests, memory might look like.</p>
<div class="divdgm">
<div id="LocalHeapaloc">
</div>
</div>
<p>Each allocation request reserves a contiguous area of the requested
size in the heap and returns a reference to that new block to the
program.
Since each block is always referred to by a reference, the block
always plays the role of a “pointee” (Section 1) and the program
always manipulates its heap blocks through references.
The heap block references are sometimes known as “base address”
pointers since by convention they point to the base (lowest address
byte) of the block.
In this example, the three blocks have been allocated contiguously
starting at the bottom of the heap, and each block is 1024 bytes in
size as requested.
In reality, the heap manager can allocate the blocks wherever it wants
in the heap so long as the blocks do not overlap and they are at least
the requested size.
At any particular moment, some areas in the heap have been allocated
to the program, and so are “in use”.
Other areas have yet to be committed and so are “free” and are
available to satisfy allocation requests.
The heap manager has its own, private data structures to record what
areas of the heap are committed to what purpose at any moment.
The heap manager satisfies each allocation request from the pool of
free memory and updates its private data structures to record which
areas of the heap are in use.</p>
</div>
<div class="section" id="deallocation">
<h3>2.<span class="section-number">6.1.2. </span>Deallocation<a class="headerlink" href="#deallocation" title="Permalink to this headline">¶</a></h3>
<p>When the program is finished using a block of memory, in some
languages the block must be explicitly deallocated.
In such cases, the block will be marked unused.
In Java, typically space is “made available” by not having any
references to it.
This allows Java garbage collection to know that this area must be
cleaned.
Garbage collection will implicitly free up the unused memory blocks in
the heap.
The heap manager updates its private data structures to show that the
area of memory occupied by the block is free again and so may be
re-used to satisfy future allocation requests.
Here’s what the heap would look like if the garbage collection
deallocates the second of the three blocks.</p>
<div class="divdgm">
<div id="LocalHeapdealoc">
</div>
</div>
<p>After deallocation, the reference continues to point to the now
deallocated block.
The program can no longer reach the deallocated pointee.
In a language (like C++) with explicit memory deallocation and no
garbage collection, the programmer must make sure that he or she does
not try to follow the old reference to the deallocated block.
This is why the pointer is drawn in gray—the pointer is there,
but it must not be used.
Of course, in Java the code will have set the pointer to <code class="docutils literal notranslate"><span class="pre">null</span></code> or
to point to somewhere else, so as to tell the garbage collection that
this object is now unused.
This is a big part of why Java references are safer to use than C++
pointers.</p>
</div>
<div class="section" id="programming-the-heap">
<h3>2.<span class="section-number">6.1.3. </span>Programming the Heap<a class="headerlink" href="#programming-the-heap" title="Permalink to this headline">¶</a></h3>
<p>Programming the heap looks pretty much the same in most languages.
The basic features are:</p>
<ul class="simple">
<li><p>The heap is an area of memory available to allocate areas (“blocks”)
of memory for the program.</p></li>
<li><p>There is some “heap manager” library code which manages the heap for
the program.
The programmer makes requests to the heap manager, which in turn
manages the internals of the heap.</p></li>
<li><p>The heap manager uses its own private data structures to keep track
of which blocks in the heap are “free” (available for use) and which
blocks are currently in use by the program and how large those
blocks are.
Initially, all of the heap is free.</p></li>
<li><p>The heap may be of a fixed size (the usual conceptualization), or it
may appear to be of a fixed but extremely large size backed by
virtual memory.
In either case, it is possible for the heap to get
“full” if all of its memory has been allocated and so it cannot
satisfy an allocation request.
The allocation function will communicate this run-time condition in
some way to the program—usually by raising an OutOfMemoryError
run-time exception.</p></li>
<li><p>The allocation function requests a block in the heap of a particular
size.
The heap manager selects an area of memory to use to satisfy
the request, marks that area as “in use” in its private data
structures, and returns a reference to the heap block.
The caller is now free to use that memory by following the
reference.
The block is guaranteed to be reserved for the sole use of the
caller—the heap will not hand out that same area of memory to
some other caller.
The block does not move around inside the heap—its
location and size are fixed once it is allocated.</p></li>
<li><p>The Java virtual machine invokes the garbage collection to remove
any unused block of memory, free its space and return this space of
memory to the heap free area for later re-use.</p></li>
</ul>
</div>
<div class="section" id="a-heap-example">
<h3>2.<span class="section-number">6.1.4. </span>A Heap Example<a class="headerlink" href="#a-heap-example" title="Permalink to this headline">¶</a></h3>
<div id="LocalHeapintptr42" class="ssAV" data-points="0.0" data-threshold="1.0" data-type="ss" data-required="False" data-short-name="LocalHeapintptr42" data-long-name="LocalHeapintptr42" data-exer-id="" alt="LocalHeapintptr42" tabIndex="-1">
 <span class="jsavcounter"></span>
 <a class="jsavsettings" href="#">Settings</a>
 <div class="jsavcontrols"></div>
 <p class="jsavoutput jsavline"></p>
 <div class="jsavcanvas"></div>
 <div class="prof_indicators">
  <img id="LocalHeapintptr42_check_mark" class="prof_check_mark" src="_static/Images/green_check.png" alt="Proficient" />
  <span id="LocalHeapintptr42_cm_saving_msg" class="cm_saving_msg">Saving...</span>
  <span id="LocalHeapintptr42_cm_error_msg" class="cm_error_msg">
   <img id="LocalHeapintptr42_cm_warning_icon" class="cm_warning_icon" src="_static/Images/warning.png" alt="Error Saving" /><br />
   Server Error<br />
   <a href="#" class="resubmit_link">Resubmit</a>
  </span>
 </div>
</div>
<p></p>
</div>
<div class="section" id="arrays">
<h3>2.<span class="section-number">6.1.5. </span>Arrays<a class="headerlink" href="#arrays" title="Permalink to this headline">¶</a></h3>
<p>In Java, array memory is allocated in the heap.
The size of the array memory block is the size of each element
multiplied by the number of elements.
So the following code heap allocates an array of 100 <code class="docutils literal notranslate"><span class="pre">Fraction</span></code>
objects in the heap, sets them all to 22/7, and deallocates the heap
array.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Fraction class</span>
<span class="kd">class</span> <span class="nc">Fraction</span> 
  <span class="kt">int</span> <span class="n">numerator</span><span class="p">,</span> <span class="n">denominator</span><span class="p">;</span>

  <span class="c1">// Fraction constructor</span>
  <span class="kd">public</span> <span class="nf">Fraction</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">,</span> <span class="kt">int</span> <span class="n">den</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">num</span><span class="p">;</span>
    <span class="n">denominator</span> <span class="o">=</span> <span class="n">den</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Test class</span>
<span class="kd">class</span> <span class="nc">TestHeapArray</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Fraction</span><span class="o">[]</span> <span class="n">fracts</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    
    <span class="c1">// allocate the array</span>
    <span class="n">fracts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Fraction</span><span class="o">[</span><span class="n">length</span><span class="o">]</span><span class="p">;</span>
    <span class="c1">// use it like an array -- in this case set them all to 22/7</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fracts</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// Remove access to the array, making it garbage.</span>
    <span class="c1">// If the Fraction objects that were created are also garbage now.</span>
    <span class="n">fracts</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example the array is dynamically allocated memory in
two steps:</p>
<ul class="simple">
<li><p>The first step when the array is created using
<code class="docutils literal notranslate"><span class="pre">fracts</span> <span class="pre">=</span> <span class="pre">new</span> <span class="pre">Fraction[100];</span></code>.
This line is used to allocate dynamic array of 100 references to
<code class="docutils literal notranslate"><span class="pre">Fractions</span></code>.
All references are initialized to <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p></li>
<li><p>The second step was inside the loop.
Every loop iteration uses <code class="docutils literal notranslate"><span class="pre">new</span></code> to dynamically allocate an
object of type <code class="docutils literal notranslate"><span class="pre">Fraction</span></code>.
The initial value of each object determined
by the values sent to the Fraction constructor.</p></li>
</ul>
<p>Heap memory provides greater control for the programmer—the
blocks of memory can be requested in any size, and they remain
allocated until they are no longer pointed to and recovered by the
garbage collector.
An object in heap memory can be passed back to the caller of a
function, since it is not deallocated when that function exits.
And it can be used to build linked structures
such as linked lists and binary trees.
The disadvantage of heap memory is that the program must make
explicit allocation calls to manage the heap memory, and the program
has to wait when the garbage collector runs.
The heap memory does not operate automatically
and conveniently the way local memory does.</p>
<script type="text/javascript" src="../../../AV/Pointers/garbageDisposalCON.js"></script>
<script type="text/javascript" src="../../../AV/Pointers/LocalHeapaloc.js"></script>
<script type="text/javascript" src="../../../AV/Pointers/LocalHeapdealoc.js"></script>
<script type="text/javascript" src="../../../AV/Pointers/LocalHeapintptr42.js"></script>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      <p><span class="email_div" style="display:inline;"><a id="contact_us" class="contact" style="float:left;color:blue;" rel="nofollow" href="mailto:">Contact Us |</a><a style="float:left;color:blue;" rel="nofollow" href="../../../lib/Privacy.html" target="_blank">| Privacy |</a> <a style="float:left;color:blue;" rel="nofollow" href="../../../lib/license.html" target="_blank">| License</a></span>&#160;&#160;
      
        «&#160;&#160;<a id="prevmod1" href="LocalMem.html">2.<span class="section-number">5. </span>Local Memory</a>
        &#160;&#160;::&#160;&#160;
        <a  class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a  id="nextmod1" href="Links1.html">2.<span class="section-number">7. </span>Link Nodes</a>&#160;&#160;»

</p>
      </div>
      <img style="float:right;" src="_static/nsf1.gif" height="62" width="62" alt="nsf"/>


    <div class="footer">
      <p>
        <span class="email_div" style="display:inline;">
          <a id="contact_us" class="contact" style="float:left;color:blue;" rel="nofollow" href="mailto:">Contact Us |</a>
          <a id="bugreport-link" style="float:left;color:blue;" class="bugreport-link" href="#">| Report a bug</a>
        </span>
      </p>
        &copy; Copyright 2016 by OpenDSA Project Contributors and distributed under an MIT license.
      Last updated on Nov 24, 2021.
      Created using <a target="_blank" href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.4.
    </div>
    
<div id="bugreport-box" class="bugreport-popup ">
  <a href="#" class="close"><img src="_static/Images/close_pop.png" class="btn_close" title="Close Window" alt="Close Window" /></a>
  <form method="post" class="report" action="https://#">
    <fieldset class="textbox">
      <div id="bug_error" class="error"></div>
      <label>
        <span>Summary*:</span>
        <input type="text" id="b_title" placeholder="Summary" />
      </label>

      <label class="os">
        <span>Operating system*:</span>
        <select id="b_os">
          <option value="windows">Windows</option>
          <option value="macos">Mac OS</option>
          <option value="linux">Linux</option>
          <option value="ios">iOS</option>
          <option value="android">Android</option>
          <option value="other">Other</option>
        </select>
      </label>

      <label class="browser">
        <span>Browser*:</span>
        <select id="b_browser">
          <option value="chrome">Chrome</option>
          <option value="safari">Safari</option>
          <option value="internetexplorer">Internet Explorer</option>
          <option value="opera">Opera</option>
          <option value="other">Other</option>
        </select>
      </label>

      <label class="description">
        <span>Description*:</span><br>
        <textarea id="b_description" rows="5" cols="25" placeholder="***BUG** Please enter: (1) a consice description of the problem. (2) steps to reproduce bug. (3) the version of your browser and operating system."></textarea>
      </label>

      <label class="screenshot">
        <span>Attach a screenshot (optional):</span>
        <input type="file" id="b_screenshot" accept="image/*" placeholder="Attach a screenshot (optional)">
      </label>

      <p>
        <input type="submit" id="bug-submit-button" value="Submit &rarr;"/>
      </p>
    </fieldset>
  </form>
</div>

  </body>
</html>